<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>제주중학교 사건 유가족 후원 - 교사유가족협의회</title>
    <meta name="description" content="선생님의 억울한 죽음과 남겨진 가족들의 생계를 위한 후원에 동참해주세요.">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            bg: '#FFF8F0',
                            primary: '#FF8A65',
                            dark: '#D84315',
                            accent: '#FFD54F',
                            text: '#4E342E',
                            surface: '#FFFFFF',
                            muted: '#D7CCC8'
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans KR"', 'sans-serif'],
                        serif: ['"Song Myung"', 'serif'],
                    },
                    animation: {
                        'fade-in-up': 'fadeInUp 0.8s ease-out forwards',
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- Fonts & Libs -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700&family=Song+Myung&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <link rel="stylesheet" href="style.css">
</head>
<body class="antialiased flex flex-col min-h-screen text-brand-text bg-brand-surface relative">

    <!-- Reservation Overlay -->
    <div id="reservation-overlay" class="fixed inset-0 z-[100] bg-brand-bg flex items-center justify-center hidden">
        <div class="text-center p-8 animate-fade-in-up">
            <div class="mb-6 text-brand-primary opacity-50">
                <i data-lucide="clock" class="w-16 h-16 mx-auto"></i>
            </div>
            <h1 class="font-serif text-4xl mb-4 text-brand-dark font-bold">준비 중입니다</h1>
            <p class="text-lg text-brand-text mb-8" id="release-date-msg">곧 공개됩니다.</p>
            <button onclick="document.getElementById('login-modal').showModal()" class="text-sm text-gray-400 underline">관리자 접속</button>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast-container" class="fixed top-24 left-1/2 transform -translate-x-1/2 z-50 pointer-events-none">
        <div id="toast" class="bg-gray-900/90 backdrop-blur text-white px-6 py-3 rounded-full shadow-xl opacity-0 transition-opacity duration-300 flex items-center gap-3">
            <i data-lucide="check-circle" class="w-5 h-5 text-green-400"></i>
            <span id="toast-message">알림</span>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="sticky top-0 z-40 bg-brand-surface/90 backdrop-blur-md border-b border-brand-muted transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex-shrink-0 flex items-center cursor-pointer" onclick="window.scrollTo(0,0)">
                    <span class="font-serif text-2xl font-bold text-brand-dark tracking-tight">TBFA</span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="#story" class="text-brand-text hover:text-brand-primary transition-colors font-medium nav-story">이야기</a>
                    <a href="#mission" class="text-brand-text hover:text-brand-primary transition-colors font-medium nav-mission">약속</a>
                    <a href="#plan" class="text-brand-text hover:text-brand-primary transition-colors font-medium nav-plan">후원</a>
                    <a href="#posters" class="text-brand-text hover:text-brand-primary transition-colors font-medium nav-posters">참여</a>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-btn" class="text-brand-text p-2"><i data-lucide="menu"></i></button>
                </div>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-brand-surface border-t border-brand-muted shadow-xl">
            <div class="px-4 pt-2 pb-4 space-y-2">
                <a href="#story" class="block py-3 font-medium nav-story">이야기</a>
                <a href="#mission" class="block py-3 font-medium nav-mission">약속</a>
                <a href="#plan" class="block py-3 font-medium nav-plan">후원</a>
                <a href="#posters" class="block py-3 font-medium nav-posters">참여</a>
            </div>
        </div>
    </nav>

    <main class="flex-grow">
        <!-- Hero -->
        <header id="hero-section" class="relative bg-brand-dark text-white overflow-hidden h-[80vh] min-h-[600px] flex items-center">
            <div class="absolute inset-0">
                <img id="hero-image" class="w-full h-full object-cover opacity-40" src="" alt="Background">
                <div class="absolute inset-0 bg-gradient-to-t from-brand-dark via-brand-dark/50 to-transparent"></div>
            </div>
            <div class="relative max-w-5xl mx-auto px-4 text-center z-10 pt-10">
                <h1 id="hero-title" class="font-serif text-4xl md:text-6xl lg:text-7xl font-bold mb-6 leading-tight text-shadow animate-fade-in-up break-keep"></h1>
                <p id="hero-subtitle" class="text-lg md:text-xl text-white/90 max-w-3xl mx-auto mb-10 font-light leading-relaxed break-keep animate-fade-in-up" style="animation-delay: 0.2s"></p>
                <div class="flex flex-col sm:flex-row justify-center gap-4 animate-fade-in-up" style="animation-delay: 0.4s">
                    <a href="#plan" class="bg-brand-accent text-brand-text hover:bg-white hover:scale-105 px-10 py-4 rounded-full font-bold text-lg transition-all shadow-lg flex items-center justify-center gap-2">
                        <i data-lucide="heart" class="w-5 h-5 fill-current"></i> 후원 동참하기
                    </a>
                    <button id="btn-share-hero" class="bg-white/10 backdrop-blur border border-white/30 hover:bg-white hover:text-brand-dark px-10 py-4 rounded-full font-bold text-lg transition-all flex items-center justify-center gap-2">
                        <i data-lucide="share-2" class="w-5 h-5"></i> 알리기
                    </button>
                </div>
            </div>
        </header>

        <!-- Sticky Stats -->
        <section class="sticky top-16 z-30 bg-brand-surface/95 backdrop-blur shadow-sm py-3 border-b border-brand-muted">
            <div class="max-w-5xl mx-auto px-4">
                <div class="flex justify-between items-end mb-1">
                    <span class="text-brand-text text-xs font-bold flex items-center gap-1"><i data-lucide="trending-up" class="w-3 h-3"></i> 달성률</span>
                    <span class="text-brand-primary font-bold text-xl" id="progress-percentage">0%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                    <div id="progress-bar" class="bg-brand-primary h-full rounded-full transition-all duration-1000" style="width: 0%"></div>
                </div>
                <div class="flex justify-between mt-1 text-xs text-gray-500 font-medium">
                    <span id="current-amount" class="text-brand-dark font-bold">0원</span>
                    <span id="goal-amount">목표 0원</span>
                </div>
            </div>
        </section>

        <!-- Story -->
        <section id="story" class="py-20 bg-brand-bg">
            <div class="max-w-5xl mx-auto px-4 space-y-24">
                <div class="text-center mb-12">
                    <span class="text-brand-primary font-bold tracking-widest uppercase text-xs">THE TRUTH</span>
                    <h2 class="font-serif text-4xl font-bold text-brand-dark mt-2 section-title-story">기억해야 할 이야기</h2>
                </div>
                <div id="story-container" class="space-y-24"></div>
            </div>
        </section>

        <!-- Mission -->
        <section id="mission" class="py-20 bg-white">
            <div class="max-w-7xl mx-auto px-4">
                <div class="text-center mb-16">
                    <span class="text-brand-primary font-bold tracking-widest uppercase text-xs">OUR PROMISE</span>
                    <h2 class="font-serif text-4xl font-bold text-brand-dark mt-2 mb-4 section-title-mission">우리의 3가지 약속</h2>
                    <p class="text-gray-600 max-w-2xl mx-auto break-keep">후원금은 운영비를 제외한 전액, 유가족의 회복을 위해 투명하게 사용됩니다.</p>
                </div>
                <div class="grid md:grid-cols-3 gap-8" id="goals-container"></div>
            </div>
        </section>

        <!-- Posters -->
        <section id="posters" class="py-20 bg-brand-bg">
            <div class="max-w-7xl mx-auto px-4">
                <div class="text-center mb-12">
                    <h2 class="font-serif text-4xl font-bold text-brand-dark mb-4 section-title-posters">함께 나누는 마음</h2>
                    <p class="text-gray-600">이미지를 저장하여 주변에 널리 알려주세요.</p>
                </div>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6" id="poster-grid"></div>
            </div>
        </section>

        <!-- Plan -->
        <section id="plan" class="py-20 bg-white">
            <div class="max-w-4xl mx-auto px-4">
                <div class="bg-brand-bg rounded-3xl p-8 md:p-12 shadow-xl border border-brand-muted text-center">
                    <h2 class="font-serif text-3xl md:text-4xl font-bold text-brand-dark mb-8 section-title-plan">후원 참여 안내</h2>
                    
                    <div class="bg-white p-4 rounded-2xl shadow-sm inline-block mb-8">
                        <div id="qr-container" class="w-32 h-32 bg-gray-100"></div>
                    </div>
                    
                    <div class="mb-8">
                        <div class="bg-white border rounded-xl p-6 max-w-md mx-auto shadow-sm">
                            <p class="text-xs text-gray-500 mb-1">농협은행</p>
                            <div class="flex items-center justify-center gap-3">
                                <p class="text-2xl font-bold text-brand-primary" id="bank-account">351-1234-5678-91</p>
                                <button id="btn-copy-account" class="text-gray-400 hover:text-brand-primary"><i data-lucide="copy" class="w-5 h-5"></i></button>
                            </div>
                            <p class="text-sm font-medium mt-2 text-gray-700">예금주: 교사유가족협의회</p>
                        </div>
                    </div>

                    <div class="grid gap-3 max-w-sm mx-auto">
                        <button onclick="document.getElementById('plan-modal').showModal()" class="w-full bg-white border hover:border-brand-primary hover:text-brand-primary py-3 rounded-xl flex justify-between px-6 transition-colors shadow-sm font-bold text-sm">
                            상세 후원 계획서 <i data-lucide="arrow-right" class="w-4 h-4"></i>
                        </button>
                        <button onclick="document.getElementById('budget-modal').showModal()" class="w-full bg-white border hover:border-brand-primary hover:text-brand-primary py-3 rounded-xl flex justify-between px-6 transition-colors shadow-sm font-bold text-sm">
                            예산 배분 계획 <i data-lucide="arrow-right" class="w-4 h-4"></i>
                        </button>
                    </div>
                    
                    <div class="mt-8 pt-8 border-t border-brand-muted/50 text-sm text-gray-500">
                        <p>후원 문의: <a href="mailto:support@tbfa.org" class="underline">support@tbfa.org</a></p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-brand-text text-brand-bg/60 py-12">
        <div class="max-w-7xl mx-auto px-4 grid md:grid-cols-3 gap-8">
            <div>
                <a href="#" class="text-white font-serif text-xl block mb-4">교사유가족협의회</a>
                <p class="text-sm">선생님의 억울함을 풀고 남겨진 가족들이<br>다시 일어설 수 있도록 끝까지 함께하겠습니다.</p>
            </div>
            <div>
                <h4 class="text-white font-bold mb-4 text-sm">Contact</h4>
                <ul class="space-y-2 text-sm">
                    <li class="flex items-center gap-2"><i data-lucide="mail" class="w-4 h-4"></i> support@tbfa.org</li>
                    <li class="flex items-center gap-2"><i data-lucide="phone" class="w-4 h-4"></i> 02-1234-5678</li>
                </ul>
            </div>
            <div>
                <h4 class="text-white font-bold mb-4 text-sm">Admin</h4>
                <button onclick="document.getElementById('login-modal').showModal()" class="border border-white/20 hover:border-white px-3 py-1 rounded text-xs transition-colors flex items-center gap-2">
                    <i data-lucide="lock" class="w-3 h-3"></i> 관리자 로그인
                </button>
            </div>
        </div>
        <div class="text-center mt-8 pt-8 border-t border-white/10 text-xs opacity-50">
            &copy; 2025 Teachers Bereaved Families Association.
        </div>
    </footer>

    <!-- Modals -->
    <dialog id="plan-modal" class="modal rounded-2xl max-w-4xl w-full backdrop:bg-black/60 p-0 shadow-2xl">
        <div class="bg-white flex flex-col max-h-[90vh]">
            <div class="flex justify-between items-center p-4 border-b sticky top-0 bg-white z-10">
                <h3 class="font-bold text-lg">상세 후원 계획서</h3>
                <button onclick="this.closest('dialog').close()" class="p-1 hover:bg-gray-100 rounded"><i data-lucide="x"></i></button>
            </div>
            <div class="p-8 overflow-y-auto prose prose-sm max-w-none" id="plan-content"></div>
        </div>
    </dialog>

    <dialog id="budget-modal" class="modal rounded-2xl max-w-4xl w-full backdrop:bg-black/60 p-0 shadow-2xl">
        <div class="bg-white flex flex-col max-h-[90vh]">
            <div class="flex justify-between items-center p-4 border-b sticky top-0 bg-white z-10">
                <h3 class="font-bold text-lg">예산 배분 계획</h3>
                <button onclick="this.closest('dialog').close()" class="p-1 hover:bg-gray-100 rounded"><i data-lucide="x"></i></button>
            </div>
            <div class="p-8 overflow-y-auto">
                <div class="h-64 mb-8"><canvas id="budgetChart"></canvas></div>
                <div class="prose prose-sm max-w-none" id="budget-content"></div>
            </div>
        </div>
    </dialog>

    <dialog id="login-modal" class="modal rounded-xl max-w-sm w-full backdrop:bg-black/80 p-6 shadow-2xl">
        <div class="text-center mb-6">
            <h3 class="font-serif text-xl font-bold">관리자 로그인</h3>
        </div>
        <form id="login-form" class="space-y-3">
            <input type="text" id="admin-id" class="w-full border rounded px-3 py-2 outline-none focus:border-brand-primary" placeholder="아이디 (tbfa)">
            <input type="password" id="admin-pw" class="w-full border rounded px-3 py-2 outline-none focus:border-brand-primary" placeholder="비밀번호">
            <div class="text-right">
                <button type="button" id="find-pw-btn" class="text-xs text-brand-primary">비밀번호 찾기</button>
            </div>
            <button type="submit" class="w-full bg-brand-dark text-white font-bold py-3 rounded hover:bg-brand-primary transition-colors flex justify-center items-center">
                <span id="login-text">로그인</span>
                <span id="login-spinner" class="loader ml-2 hidden"></span>
            </button>
        </form>
        <button onclick="this.closest('dialog').close()" class="absolute top-3 right-3 text-gray-400"><i data-lucide="x" class="w-4 h-4"></i></button>
    </dialog>

    <!-- Admin Panel -->
    <div id="admin-panel" class="fixed inset-0 z-[110] bg-gray-100 hidden overflow-hidden flex flex-col">
        <header class="bg-brand-dark text-white flex-none">
            <div class="max-w-7xl mx-auto px-4 h-14 flex justify-between items-center">
                <div class="flex items-center gap-2 cursor-pointer" onclick="renderSection('dashboard')">
                    <span class="font-bold text-lg">TBFA Admin</span>
                    <span class="bg-white/20 text-xs px-2 py-0.5 rounded">V2.0</span>
                </div>
                <div class="flex gap-3">
                    <button id="admin-save-all" class="bg-brand-accent text-brand-text text-xs font-bold px-3 py-1.5 rounded hover:bg-white flex items-center gap-1">
                        <i data-lucide="save" class="w-3 h-3"></i> 저장
                    </button>
                    <button id="admin-logout" class="text-white/80 hover:text-white text-xs underline">로그아웃</button>
                </div>
            </div>
        </header>

        <div class="flex-grow flex overflow-hidden">
            <!-- Sidebar -->
            <aside class="w-64 bg-white border-r overflow-y-auto hidden lg:block flex-none" id="admin-sidebar">
                <div class="p-4">
                    <h5 class="text-xs font-bold text-gray-400 mb-3 uppercase tracking-wider">Workflow</h5>
                    <ul class="space-y-1 text-sm">
                        <li><a href="#" data-target="dashboard" onclick="renderSection('dashboard')" class="flex items-center gap-2 p-2 rounded hover:bg-gray-50"><i data-lucide="grid" class="w-4 h-4"></i> 대시보드</a></li>
                        <li><a href="#" data-target="stats" onclick="renderSection('stats')" class="flex items-center gap-2 p-2 rounded hover:bg-gray-50"><i data-lucide="bar-chart-2" class="w-4 h-4"></i> 방문자 통계</a></li>
                        <li><div class="h-px bg-gray-100 my-2"></div></li>
                        <li><a href="#" data-target="hero" onclick="renderSection('hero')" class="flex items-center gap-2 p-2 rounded hover:bg-gray-50"><i data-lucide="layout-template" class="w-4 h-4"></i> 메인 화면 편집</a></li>
                        <li><a href="#" data-target="story" onclick="renderSection('story')" class="flex items-center gap-2 p-2 rounded hover:bg-gray-50"><i data-lucide="book-open" class="w-4 h-4"></i> 스토리텔링</a></li>
                        <li><a href="#" data-target="docs" onclick="renderSection('docs')" class="flex items-center gap-2 p-2 rounded hover:bg-gray-50"><i data-lucide="file-text" class="w-4 h-4"></i> 계획서/예산</a></li>
                        <li><a href="#" data-target="tools" onclick="renderSection('tools')" class="flex items-center gap-2 p-2 rounded hover:bg-gray-50"><i data-lucide="settings" class="w-4 h-4"></i> 도구/설정</a></li>
                    </ul>
                </div>
            </aside>
            
            <!-- Content -->
            <div class="flex-grow overflow-y-auto p-4 lg:p-8 bg-gray-50" id="admin-content">
                <!-- Dynamic Content -->
            </div>
        </div>
    </div>

    <script type="module" src="./data_store.js"></script>
    <script type="module" src="./script.js"></script>
    <script type="module" src="./admin.js"></script>
    <script type="module">
        import { store } from './data_store.js';
        store.trackVisit();
    </script>
</body>
</html>
